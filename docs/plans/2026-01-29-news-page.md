# News Page Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Create a unified news feed combining curated links, blog posts, and portfolio company announcements.

**Architecture:**
- Single data source (`src/data/news.ts`) for curated links and announcements
- Unified NewsItem type that normalizes all content types (curated, blog, announcement)
- NewsGrid component with filtering by source type
- Blog posts pulled from existing `/content/blog/` via `getAllPosts()`
- Chronological feed sorted by date (newest first)

**Tech Stack:** Next.js App Router, TypeScript, Tailwind CSS, existing blog infrastructure

---

## Phase 1: Data Layer

### Task 1: Create News Data Types

**Files:**
- Create: `src/data/news.ts`

**Step 1: Create the news data file with types**

```typescript
export type NewsSource = "curated" | "blog" | "announcement";

export type NewsCategory =
  | "crypto"
  | "ai"
  | "infrastructure"
  | "defi"
  | "research"
  | "product"
  | "funding"
  | "general";

export interface CuratedLink {
  id: string;
  type: "curated";
  title: string;
  url: string;
  source: string; // e.g., "Vitalik's Blog", "a]l6z", "Paradigm"
  date: string; // ISO 8601
  description?: string;
  category: NewsCategory;
  featured?: boolean;
}

export interface Announcement {
  id: string;
  type: "announcement";
  title: string;
  url: string;
  company: string; // Portfolio company name
  companyLogo?: string; // Path to logo
  platform: "x" | "blog" | "discord" | "github" | "other";
  date: string;
  description?: string;
  category: NewsCategory;
  featured?: boolean;
}

export type NewsItem = CuratedLink | Announcement | {
  id: string;
  type: "blog";
  title: string;
  url: string;
  date: string;
  description?: string;
  category: NewsCategory;
  readingTime?: string;
};

export const categoryLabels: Record<NewsCategory, string> = {
  crypto: "Crypto",
  ai: "AI",
  infrastructure: "Infrastructure",
  defi: "DeFi",
  research: "Research",
  product: "Product",
  funding: "Funding",
  general: "General",
};

// Curated links - external articles worth reading
export const curatedLinks: CuratedLink[] = [
  // Example entry:
  // {
  //   id: "vitalik-endgame-2024",
  //   type: "curated",
  //   title: "Endgame",
  //   url: "https://vitalik.eth.limo/general/2024/01/endgame.html",
  //   source: "Vitalik Buterin",
  //   date: "2024-01-15",
  //   description: "Thoughts on the long-term future of Ethereum.",
  //   category: "crypto",
  //   featured: true,
  // },
];

// Portfolio company announcements
export const announcements: Announcement[] = [
  // Example entry:
  // {
  //   id: "monad-testnet-launch",
  //   type: "announcement",
  //   title: "Monad Testnet is Live",
  //   url: "https://x.com/monad_xyz/status/...",
  //   company: "Monad",
  //   companyLogo: "/images/investments/monad.jpg",
  //   platform: "x",
  //   date: "2024-12-01",
  //   description: "Monad testnet launches with 10,000 TPS.",
  //   category: "product",
  //   featured: true,
  // },
];
```

**Step 2: Commit**

```bash
git add src/data/news.ts
git commit -m "feat: add news data types and structures"
```

---

### Task 2: Create News Aggregation Library

**Files:**
- Create: `src/lib/news.ts`

**Step 1: Create the news aggregation library**

```typescript
import { getAllPosts } from "./blog";
import { curatedLinks, announcements, NewsItem, NewsCategory } from "@/data/news";

export interface AggregatedNewsItem {
  id: string;
  type: "curated" | "blog" | "announcement";
  title: string;
  url: string;
  date: string;
  description?: string;
  category: NewsCategory;
  featured?: boolean;
  // Type-specific fields
  source?: string; // For curated links
  company?: string; // For announcements
  companyLogo?: string; // For announcements
  platform?: string; // For announcements
  readingTime?: string; // For blog posts
}

export async function getAllNews(): Promise<AggregatedNewsItem[]> {
  // Get blog posts
  const blogPosts = await getAllPosts();
  const blogItems: AggregatedNewsItem[] = blogPosts.map((post) => ({
    id: `blog-${post.slug}`,
    type: "blog" as const,
    title: post.title,
    url: `/blog/${post.slug}`,
    date: post.date,
    description: post.description,
    category: "general" as NewsCategory, // Default category for blog posts
    readingTime: post.readingTime,
  }));

  // Get curated links
  const curatedItems: AggregatedNewsItem[] = curatedLinks.map((link) => ({
    id: link.id,
    type: "curated" as const,
    title: link.title,
    url: link.url,
    date: link.date,
    description: link.description,
    category: link.category,
    featured: link.featured,
    source: link.source,
  }));

  // Get announcements
  const announcementItems: AggregatedNewsItem[] = announcements.map((ann) => ({
    id: ann.id,
    type: "announcement" as const,
    title: ann.title,
    url: ann.url,
    date: ann.date,
    description: ann.description,
    category: ann.category,
    featured: ann.featured,
    company: ann.company,
    companyLogo: ann.companyLogo,
    platform: ann.platform,
  }));

  // Combine and sort by date (newest first)
  const allNews = [...blogItems, ...curatedItems, ...announcementItems];
  allNews.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

  return allNews;
}

export function filterNewsByType(
  news: AggregatedNewsItem[],
  type: "all" | "curated" | "blog" | "announcement"
): AggregatedNewsItem[] {
  if (type === "all") return news;
  return news.filter((item) => item.type === type);
}

export function filterNewsByCategory(
  news: AggregatedNewsItem[],
  category: "all" | NewsCategory
): AggregatedNewsItem[] {
  if (category === "all") return news;
  return news.filter((item) => item.category === category);
}
```

**Step 2: Commit**

```bash
git add src/lib/news.ts
git commit -m "feat: add news aggregation library"
```

---

## Phase 2: UI Components

### Task 3: Create NewsGrid Component

**Files:**
- Create: `src/components/NewsGrid.tsx`

**Step 1: Create the NewsGrid component**

```tsx
"use client";

import { useState, useMemo } from "react";
import Image from "next/image";
import { AggregatedNewsItem } from "@/lib/news";
import { NewsCategory, categoryLabels } from "@/data/news";
import { CustomSelect } from "./CustomSelect";

interface NewsGridProps {
  news: AggregatedNewsItem[];
}

const typeLabels: Record<string, string> = {
  all: "All",
  blog: "Blog Posts",
  curated: "Curated Links",
  announcement: "Announcements",
};

const platformIcons: Record<string, JSX.Element> = {
  x: (
    <svg className="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
      <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
    </svg>
  ),
  blog: (
    <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
      <polyline points="14 2 14 8 20 8" />
      <line x1="16" y1="13" x2="8" y2="13" />
      <line x1="16" y1="17" x2="8" y2="17" />
    </svg>
  ),
  github: (
    <svg className="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
      <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
    </svg>
  ),
  discord: (
    <svg className="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
      <path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189z" />
    </svg>
  ),
  other: (
    <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
      <circle cx="12" cy="12" r="10" />
      <line x1="2" y1="12" x2="22" y2="12" />
      <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
    </svg>
  ),
};

function formatDate(dateString: string): string {
  const date = new Date(dateString);
  return new Intl.DateTimeFormat("en-US", {
    month: "short",
    day: "numeric",
    year: "numeric",
  }).format(date);
}

export function NewsGrid({ news }: NewsGridProps) {
  const [typeFilter, setTypeFilter] = useState<string>("all");
  const [categoryFilter, setCategoryFilter] = useState<string>("all");
  const [searchQuery, setSearchQuery] = useState("");

  // Get unique categories from news items
  const categories = useMemo(() => {
    const cats = new Set<NewsCategory>();
    news.forEach((item) => cats.add(item.category));
    return Array.from(cats).sort();
  }, [news]);

  const filteredNews = useMemo(() => {
    return news.filter((item) => {
      // Type filter
      if (typeFilter !== "all" && item.type !== typeFilter) return false;

      // Category filter
      if (categoryFilter !== "all" && item.category !== categoryFilter) return false;

      // Search filter
      if (searchQuery) {
        const query = searchQuery.toLowerCase();
        const searchText = [
          item.title,
          item.description,
          item.source,
          item.company,
        ]
          .filter(Boolean)
          .join(" ")
          .toLowerCase();
        if (!searchText.includes(query)) return false;
      }

      return true;
    });
  }, [news, typeFilter, categoryFilter, searchQuery]);

  return (
    <div className="space-y-6">
      {/* Filters */}
      <div className="flex flex-col sm:flex-row gap-3">
        {/* Type Filter */}
        <div className="flex items-center gap-2">
          <label className="text-sm text-neutral-600 dark:text-neutral-400 whitespace-nowrap">
            Type:
          </label>
          <CustomSelect
            id="type-filter"
            value={typeFilter}
            onChange={setTypeFilter}
            options={Object.entries(typeLabels).map(([value, label]) => ({
              value,
              label,
            }))}
            className="flex-1 sm:flex-none sm:min-w-[140px]"
          />
        </div>

        {/* Category Filter */}
        <div className="flex items-center gap-2">
          <label className="text-sm text-neutral-600 dark:text-neutral-400 whitespace-nowrap">
            Category:
          </label>
          <CustomSelect
            id="category-filter"
            value={categoryFilter}
            onChange={setCategoryFilter}
            options={[
              { value: "all", label: "All Categories" },
              ...categories.map((cat) => ({
                value: cat,
                label: categoryLabels[cat],
              })),
            ]}
            className="flex-1 sm:flex-none sm:min-w-[140px]"
          />
        </div>

        {/* Search */}
        <div className="flex-1 relative">
          <input
            type="text"
            placeholder="Search news..."
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="w-full px-3 py-2 pr-9 text-sm rounded-lg border border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-100 placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-neutral-400 dark:focus:ring-neutral-600"
          />
          {searchQuery && (
            <button
              type="button"
              onClick={() => setSearchQuery("")}
              className="absolute right-2 top-1/2 -translate-y-1/2 p-1 text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-300"
            >
              <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18" />
                <line x1="6" y1="6" x2="18" y2="18" />
              </svg>
            </button>
          )}
        </div>
      </div>

      {/* Results count */}
      <div className="text-sm text-neutral-500">
        {filteredNews.length} {filteredNews.length === 1 ? "item" : "items"}
      </div>

      {/* News List */}
      <div className="space-y-4">
        {filteredNews.length === 0 ? (
          <p className="text-center py-8 text-neutral-500">
            No news found matching your criteria.
          </p>
        ) : (
          filteredNews.map((item) => (
            <a
              key={item.id}
              href={item.url}
              target={item.type === "blog" ? "_self" : "_blank"}
              rel={item.type !== "blog" ? "noopener noreferrer" : undefined}
              className="group block p-4 rounded-xl border border-neutral-200 dark:border-neutral-800 hover:border-neutral-400 dark:hover:border-neutral-600 transition-all"
            >
              <div className="flex items-start gap-4">
                {/* Icon/Logo */}
                <div className="flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-lg bg-neutral-100 dark:bg-neutral-800">
                  {item.type === "announcement" && item.companyLogo ? (
                    <Image
                      src={item.companyLogo}
                      alt={item.company || ""}
                      width={40}
                      height={40}
                      className="rounded-lg object-contain"
                    />
                  ) : item.type === "blog" ? (
                    <span className="text-lg">üìù</span>
                  ) : item.type === "curated" ? (
                    <span className="text-lg">üîó</span>
                  ) : (
                    <span className="text-lg">üì¢</span>
                  )}
                </div>

                {/* Content */}
                <div className="flex-1 min-w-0">
                  <div className="flex items-start justify-between gap-2">
                    <h3 className="font-semibold group-hover:text-neutral-600 dark:group-hover:text-neutral-300 transition-colors">
                      {item.title}
                    </h3>
                    {item.type !== "blog" && (
                      <svg
                        className="w-4 h-4 flex-shrink-0 text-neutral-400"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        strokeWidth="2"
                      >
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                        <polyline points="15 3 21 3 21 9" />
                        <line x1="10" y1="14" x2="21" y2="3" />
                      </svg>
                    )}
                  </div>

                  {item.description && (
                    <p className="mt-1 text-sm text-neutral-600 dark:text-neutral-400 line-clamp-2">
                      {item.description}
                    </p>
                  )}

                  <div className="mt-2 flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-neutral-500">
                    <span>{formatDate(item.date)}</span>

                    {item.type === "curated" && item.source && (
                      <span className="text-blue-600 dark:text-blue-400">
                        {item.source}
                      </span>
                    )}

                    {item.type === "announcement" && item.company && (
                      <span className="flex items-center gap-1 text-violet-600 dark:text-violet-400">
                        {item.platform && platformIcons[item.platform]}
                        {item.company}
                      </span>
                    )}

                    {item.type === "blog" && item.readingTime && (
                      <span>{item.readingTime}</span>
                    )}

                    <span
                      className={`px-2 py-0.5 rounded-full ${
                        item.category === "crypto"
                          ? "bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"
                          : item.category === "ai"
                            ? "bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"
                            : item.category === "defi"
                              ? "bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"
                              : "bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400"
                      }`}
                    >
                      {categoryLabels[item.category]}
                    </span>
                  </div>
                </div>
              </div>
            </a>
          ))
        )}
      </div>
    </div>
  );
}
```

**Step 2: Commit**

```bash
git add src/components/NewsGrid.tsx
git commit -m "feat: add NewsGrid component"
```

---

## Phase 3: News Page

### Task 4: Create News Page

**Files:**
- Create: `src/app/news/page.tsx`

**Step 1: Create the news page**

```tsx
import { Suspense } from "react";
import { Navbar } from "@/components/Navbar";
import { NewsGrid } from "@/components/NewsGrid";
import { getAllNews } from "@/lib/news";

export const metadata = {
  title: "News",
  description:
    "Curated links, blog posts, and announcements from dcbuilder's portfolio companies.",
};

export default async function NewsPage() {
  const news = await getAllNews();

  return (
    <>
      <Navbar />
      <main className="min-h-screen pt-20 sm:pt-24 px-4 sm:px-6">
        <div className="max-w-4xl mx-auto py-8 sm:py-12">
          {/* Header */}
          <div className="text-center mb-8 sm:mb-12">
            <h1 className="text-3xl sm:text-4xl font-bold mb-4">News</h1>
            <p className="text-neutral-600 dark:text-neutral-400 max-w-2xl mx-auto">
              Curated articles, my blog posts, and announcements from portfolio
              companies.
            </p>
          </div>

          {/* News Grid */}
          <Suspense
            fallback={
              <div className="text-center py-8 text-neutral-500">
                Loading news...
              </div>
            }
          >
            <NewsGrid news={news} />
          </Suspense>
        </div>
      </main>
    </>
  );
}
```

**Step 2: Commit**

```bash
git add src/app/news/page.tsx
git commit -m "feat: add news page"
```

---

### Task 5: Add News to Navbar

**Files:**
- Modify: `src/components/Navbar.tsx`

**Step 1: Find the navigation links array and add News**

Look for the links array (likely something like):
```tsx
const links = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  // ... other links
];
```

Add the News link after Blog:
```tsx
{ href: "/news", label: "News" },
```

**Step 2: Commit**

```bash
git add src/components/Navbar.tsx
git commit -m "feat: add News link to navbar"
```

---

## Phase 4: Add Sample Content

### Task 6: Add Sample Curated Links and Announcements

**Files:**
- Modify: `src/data/news.ts`

**Step 1: Add a few sample curated links**

```typescript
export const curatedLinks: CuratedLink[] = [
  {
    id: "vitalik-d-acc",
    type: "curated",
    title: "My techno-optimism",
    url: "https://vitalik.eth.limo/general/2023/11/27/techno_optimism.html",
    source: "Vitalik Buterin",
    date: "2023-11-27",
    description: "Vitalik's thoughts on technology, d/acc, and the future.",
    category: "crypto",
    featured: true,
  },
  {
    id: "paradigm-frontiers",
    type: "curated",
    title: "Frontiers in Mechanism Design",
    url: "https://www.paradigm.xyz/2024/01/frontiers",
    source: "Paradigm",
    date: "2024-01-15",
    description: "Research on mechanism design in crypto protocols.",
    category: "research",
  },
];
```

**Step 2: Add a sample announcement**

```typescript
export const announcements: Announcement[] = [
  {
    id: "monad-devnet",
    type: "announcement",
    title: "Monad Devnet Launch",
    url: "https://x.com/monad_xyz",
    company: "Monad",
    companyLogo: "/images/investments/monad.jpg",
    platform: "x",
    date: "2024-06-01",
    description: "Monad launches developer network with unprecedented performance.",
    category: "product",
    featured: true,
  },
];
```

**Step 3: Commit**

```bash
git add src/data/news.ts
git commit -m "feat: add sample news content"
```

---

## Phase 5: OpenGraph Image (Optional)

### Task 7: Add OpenGraph Image for News Page

**Files:**
- Create: `src/app/news/opengraph-image.tsx`

**Step 1: Copy from another page's opengraph-image.tsx and modify**

Look at `src/app/blog/opengraph-image.tsx` or `src/app/jobs/opengraph-image.tsx` as a template.

Modify the title to "News | dcbuilder.eth"

**Step 2: Commit**

```bash
git add src/app/news/opengraph-image.tsx
git commit -m "feat: add opengraph image for news page"
```

---

## Testing Checklist

- [ ] `bun run build` passes without errors
- [ ] `/news` page loads and shows all content types
- [ ] Blog posts appear with correct links (internal navigation)
- [ ] Curated links open in new tab
- [ ] Announcements show company logo and platform icon
- [ ] Type filter works (All, Blog Posts, Curated Links, Announcements)
- [ ] Category filter works
- [ ] Search filters by title/description
- [ ] Navbar shows News link
- [ ] Mobile responsive design

---

## Environment Variables

None required for this feature.

---

## Future Enhancements (Not in Scope)

- RSS feed generation for /news
- Auto-fetch announcements from Twitter/X API
- Newsletter subscription
- Pagination for large news volumes
